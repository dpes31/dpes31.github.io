<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼íƒ íˆ¬ì ê°€ëŠ¥ ì—¬ë¶€ ê³„ì‚°ê¸°</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ê¸°ë³¸ í°íŠ¸ ì„¤ì • (Tailwind default + Inter ëŒ€ì²´) */
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif; background-color: #f7f9fb; }
        /* ì…ë ¥ ì„¹ì…˜ì˜ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
        .input-group { @apply flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 bg-white border border-gray-200 rounded-xl shadow-sm mb-4; }
        .input-label { @apply text-sm font-semibold text-gray-700 w-full sm:w-1/3 mb-1 sm:mb-0; }
        .input-field { @apply w-full sm:w-2/3 flex items-center; }
        .result-box { @apply p-4 rounded-xl mb-4 text-center font-bold text-lg; }
    </style>
</head>
<body class="p-4 sm:p-8">

<div class="max-w-4xl mx-auto">
    <header class="text-center mb-8">
        <h1 class="text-3xl font-extrabold text-gray-800">ì£¼íƒ íˆ¬ì ê°€ëŠ¥ ì—¬ë¶€ ê³„ì‚°ê¸°</h1>
        <p class="text-gray-500 mt-2">ì…ë ¥ í•­ëª©ì„ ì±„ìš°ì‹œë©´, LTVì™€ DSR ê¸°ì¤€ì— ë”°ë¥¸ íˆ¬ì ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì¦‰ì‹œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </header>

    <!-- ì…ë ¥ ì„¹ì…˜ -->
    <section id="inputSection" class="mb-8 p-6 bg-white rounded-2xl shadow-2xl">
        <h2 class="text-xl font-bold text-blue-600 mb-6 border-b pb-2">ê¸°ì¬ í•­ëª© (í•„ìˆ˜ ì…ë ¥)</h2>
        
        <!-- ì—° ì†Œë“ -->
        <div class="input-group">
            <label for="annualIncome" class="input-label">âœ“ ì—° ì†Œë“ (ë¶€ë¶€í•©ì‚°, ì„¸í›„, ì–µ/ë…„)</label>
            <div class="input-field">
                <input type="number" id="annualIncome" value="1.45" step="0.01" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-right">
                <span class="ml-2 text-gray-500">ì–µ/ë…„</span>
            </div>
        </div>

        <!-- ë³´ìœ  ìê¸ˆ -->
        <div class="input-group">
            <label for="ownedAssets" class="input-label">âœ“ ë³´ìœ  ìê¸ˆ (ì–µ)</label>
            <div class="input-field">
                <input type="number" id="ownedAssets" value="15" step="0.1" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-right">
                <span class="ml-2 text-gray-500">ì–µ</span>
            </div>
        </div>

        <!-- ì£¼íƒ ë§¤ë§¤ê°€/ì²­ì•½ ë¶„ì–‘ê°€ -->
        <div class="input-group">
            <label for="purchasePrice" class="input-label">âœ“ ì£¼íƒ ë§¤ë§¤ê°€/ì²­ì•½ ë¶„ì–‘ê°€ (ì–µ)</label>
            <div class="input-field">
                <input type="number" id="purchasePrice" value="24" step="0.1" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-right">
                <span class="ml-2 text-gray-500">ì–µ</span>
            </div>
        </div>

        <!-- ëŒ€ì¶œ ê¸ˆë¦¬ -->
        <div class="input-group">
            <label for="loanRate" class="input-label">âœ“ ëŒ€ì¶œ ê¸ˆë¦¬ (ì‹œì¥ í‰ê· , %)</label>
            <div class="input-field">
                <input type="number" id="loanRate" value="4.5" step="0.1" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-right">
                <span class="ml-2 text-gray-500">%</span>
            </div>
        </div>

        <!-- ìƒí™˜ ê¸°ê°„ -->
        <div class="input-group">
            <label for="loanPeriod" class="input-label">âœ“ ìƒí™˜ ê¸°ê°„ (ë…„)</label>
            <div class="input-field">
                <input type="number" id="loanPeriod" value="30" step="1" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-right">
                <span class="ml-2 text-gray-500">ë…„</span>
            </div>
        </div>
        
        <!-- ê·œì œì§€ì—­ ì—¬ë¶€ -->
        <div class="input-group">
            <label for="isRegulated" class="input-label">âœ“ ê·œì œì§€ì—­ ì—¬ë¶€</label>
            <div class="input-field">
                <select id="isRegulated" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    <option value="Y">Y (ê·œì œì§€ì—­, LTV 50% ì ìš©)</option>
                    <option value="N" selected>N (ë¹„ê·œì œì§€ì—­, LTV 70% ì ìš©)</option>
                </select>
            </div>
        </div>

        <button onclick="calculateInvestment()" class="w-full py-3 mt-6 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition duration-300 shadow-lg">
            íˆ¬ì ê°€ëŠ¥ ì—¬ë¶€ ê³„ì‚°í•˜ê¸°
        </button>
    </section>

    <!-- ê²°ê³¼ ì„¹ì…˜ -->
    <section id="resultSection" class="p-6 bg-white rounded-2xl shadow-2xl hidden">
        <h2 class="text-xl font-bold text-red-600 mb-6 border-b pb-2">ìµœì¢… ë¶„ì„ ê²°ê³¼</h2>
        
        <!-- ìµœì¢… ê²°ê³¼ í‘œì‹œ (ê°€ì¥ ì¤‘ìš”) -->
        <div id="finalResultCard" class="p-6 rounded-xl shadow-inner mb-6 transition duration-500">
            <p id="mainResultText" class="text-2xl font-extrabold"></p>
        </div>
        
        <!-- íŠ¹ë³„ ë©”ì‹œì§€ (ë³´ìœ  ìì‚° ê´€ë ¨ ì‘ì€ ê¸€ì”¨) -->
        <p id="specialMessage" class="text-sm text-center text-gray-500 mb-6"></p>

        <div class="space-y-4">
            <h3 class="text-lg font-semibold text-gray-700 border-b pb-1">1) LTV, DSR ìµœëŒ€ í•œë„ ê²€í† </h3>
            <div class="flex justify-between p-3 bg-gray-50 rounded-lg">
                <span class="text-gray-600 font-medium">LTV ê¸°ì¤€ ìµœëŒ€ ëŒ€ì¶œì•¡</span>
                <span id="ltvMaxLoan" class="text-blue-600 font-bold"></span>
            </div>
            <div class="flex justify-between p-3 bg-gray-50 rounded-lg">
                <span class="text-gray-600 font-medium">DSR ê¸°ì¤€ ìµœëŒ€ ëŒ€ì¶œì•¡ (DSR 40%)</span>
                <span id="dsrMaxLoan" class="text-blue-600 font-bold"></span>
            </div>
            
            <h3 class="text-lg font-semibold text-gray-700 border-b pb-1 mt-6">2) í•„ìš” ìê¸ˆ ë° ìƒí™˜ì•¡ ê²€í† </h3>
            <div class="flex justify-between p-3 bg-gray-50 rounded-lg">
                <span class="text-gray-600 font-medium">í•„ìš” ëŒ€ì¶œì•¡ (ì£¼íƒê°€ - ë³´ìœ ìê¸ˆ)</span>
                <span id="loanRequired" class="text-red-600 font-bold"></span>
            </div>
            <div class="flex justify-between p-3 bg-gray-50 rounded-lg">
                <span class="text-gray-600 font-medium">í•„ìš” ëŒ€ì¶œì•¡ ìƒí™˜ ì‹œ ì—°ê°„ ìƒí™˜ì•¡</span>
                <span id="annualPaymentRequired" class="text-red-600 font-bold"></span>
            </div>
            <div class="flex justify-between p-3 bg-yellow-100 rounded-lg text-sm">
                <span class="text-gray-600 font-medium">âš ï¸ DSR í—ˆìš© ì—°ê°„ ìµœëŒ€ ìƒí™˜ì•¡</span>
                <span id="dsrMaxPayment" class="text-yellow-700 font-bold"></span>
            </div>
        </div>
    </section>
</div>

<script>
    // ì´ ì½”ë“œëŠ” ì´ì „ ëŒ€í™”ì—ì„œ ë…¼ì˜ëœ ê¸ˆìœµ ê³„ì‚° ë¡œì§ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.
    
    function calculateInvestment() {
        const annualIncome = parseFloat(document.getElementById('annualIncome').value) * 100000000; // ì–µ/ë…„ -> ì›/ë…„
        const ownedAssets = parseFloat(document.getElementById('ownedAssets').value) * 100000000; // ì–µ -> ì›
        const purchasePrice = parseFloat(document.getElementById('purchasePrice').value) * 100000000; // ì–µ -> ì›
        const loanRate = parseFloat(document.getElementById('loanRate').value) / 100; // % -> ë¹„ìœ¨
        const loanPeriod = parseInt(document.getElementById('loanPeriod').value, 10); // ë…„
        const isRegulated = document.getElementById('isRegulated').value === 'Y';
        
        const resultSection = document.getElementById('resultSection');
        const finalResultCard = document.getElementById('finalResultCard');
        const mainResultText = document.getElementById('mainResultText');
        const specialMessage = document.getElementById('specialMessage');

        // ì…ë ¥ ê°’ ìœ íš¨ì„± ê²€ì‚¬
        if (isNaN(annualIncome) || isNaN(ownedAssets) || isNaN(purchasePrice) || isNaN(loanRate) || isNaN(loanPeriod) || purchasePrice <= 0 || annualIncome <= 0 || loanRate <= 0) {
            alert('ëª¨ë“  í•„ìˆ˜ ì…ë ¥ í•­ëª©ì„ ì˜¬ë°”ë¥´ê²Œ ì±„ì›Œì£¼ì„¸ìš”. (0ë³´ë‹¤ ì»¤ì•¼ í•¨)');
            resultSection.classList.add('hidden');
            return;
        }

        // 1. LTV (ì£¼íƒë‹´ë³´ëŒ€ì¶œë¹„ìœ¨) ê¸°ì¤€ ê³„ì‚°
        const ltvRatio = isRegulated ? 0.5 : 0.7; // ê·œì œì§€ì—­ 50%, ë¹„ê·œì œì§€ì—­ 70%
        const ltvMaxLoan = purchasePrice * ltvRatio;

        // 2. DSR (ì´ë¶€ì±„ì›ë¦¬ê¸ˆìƒí™˜ë¹„ìœ¨) ê¸°ì¤€ ê³„ì‚° (40% ê¸°ì¤€)
        const dsrRatio = 0.4;
        const maxAnnualDSRPayment = annualIncome * dsrRatio; // ì—°ê°„ ìƒí™˜ ê°€ëŠ¥ ìµœëŒ€ ê¸ˆì•¡
        
        // ì›ë¦¬ê¸ˆ ê· ë“± ìƒí™˜ ë°©ì‹ì˜ ì›”ë³„ ì´ììœ¨ê³¼ ê¸°ê°„
        const monthlyRate = loanRate / 12;
        const totalMonths = loanPeriod * 12;

        // DSR ê¸°ì¤€ ìµœëŒ€ ëŒ€ì¶œì•¡ (A = P * (r * (1+r)^n) / ((1+r)^n - 1) * 12)
        // P = A / ( [r * (1+r)^n] / [((1+r)^n - 1) * 12] )
        let dsrMaxLoan;
        if (monthlyRate === 0 || totalMonths === 0) {
             // ì´ììœ¨ì´ 0ì´ê±°ë‚˜ ê¸°ê°„ì´ 0ì¸ ê²½ìš° (í˜„ì‹¤ì ìœ¼ë¡œ ë“œë¬¼ì§€ë§Œ ì•ˆì „ì¥ì¹˜)
            dsrMaxLoan = maxAnnualDSRPayment * loanPeriod; 
        } else {
            const annuityFactor = (monthlyRate * Math.pow(1 + monthlyRate, totalMonths)) / (Math.pow(1 + monthlyRate, totalMonths) - 1);
            // ì—°ê°„ ì›ë¦¬ê¸ˆ ìƒí™˜ì•¡ / (ì›” ìƒí™˜ì•¡ ë¹„ìœ¨ * 12) = ìµœëŒ€ ëŒ€ì¶œì•¡
            dsrMaxLoan = maxAnnualDSRPayment / (annuityFactor * 12); 
        }

        // 3. ì‹¤ì œ í•„ìš”í•œ ëŒ€ì¶œì•¡ ë° ìƒí™˜ì•¡ ê³„ì‚°
        const loanRequired = Math.max(0, purchasePrice - ownedAssets); // í•„ìš”í•œ ëŒ€ì¶œì•¡ (0ë³´ë‹¤ ì‘ìœ¼ë©´ 0)
        let annualPaymentRequired = 0;

        if (loanRequired > 0) {
            if (monthlyRate === 0 || totalMonths === 0) {
                annualPaymentRequired = loanRequired / loanPeriod; 
            } else {
                const annuityFactor = (monthlyRate * Math.pow(1 + monthlyRate, totalMonths)) / (Math.pow(1 + monthlyRate, totalMonths) - 1);
                annualPaymentRequired = loanRequired * annuityFactor * 12; // ì—°ê°„ ìƒí™˜ì•¡
            }
        }
        
        // 4. ìµœì¢… íˆ¬ì ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨ ë° UI ì—…ë°ì´íŠ¸
        let resultStatus = '';
        let resultColor = '';
        let resultBg = '';
        let specialMsg = '';

        if (ownedAssets >= purchasePrice) {
            // Case 1: ë³´ìœ  ìê¸ˆìœ¼ë¡œ ì „ë¶€ ì¶©ì¡±
            resultStatus = 'âœ¨ ëŒ€ì¶œ ì—†ì´ êµ¬ë§¤ ê°€ëŠ¥ âœ¨';
            resultColor = 'text-green-800';
            resultBg = 'bg-green-100 border border-green-300';
            specialMsg = 'ë³´ìœ  ìì‚°ì´ ì£¼íƒ ë§¤ë§¤ê°€ë¥¼ ì¶©ì¡±í•˜ë©°, ëŒ€ì¶œ ì—†ì´ íˆ¬ìê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.'; // ìš”ì²­í•˜ì‹  ì‘ì€ ê¸€ì”¨ ë©”ì‹œì§€
        } else {
            // ëŒ€ì¶œì´ í•„ìš”í•œ ê²½ìš°
            const isLTVPossible = loanRequired <= ltvMaxLoan;
            const isDSRPossible = annualPaymentRequired <= maxAnnualDSRPayment;

            if (isLTVPossible && isDSRPossible) {
                // Case 2: LTVì™€ DSR ëª¨ë‘ ì¶©ì¡±
                resultStatus = 'âœ… ëŒ€ì¶œë¡œ êµ¬ë§¤ ê°€ëŠ¥';
                resultColor = 'text-blue-800';
                resultBg = 'bg-blue-100 border border-blue-300';
            } else if (!isLTVPossible && isDSRPossible) {
                // Case 3: LTV ì´ˆê³¼ (ìê¸ˆ ë¶€ì¡± ê²½ê³ )
                resultStatus = 'âš ï¸ LTV í•œë„ ì´ˆê³¼ (ì¶”ê°€ ìê¸ˆ í•„ìš”)';
                resultColor = 'text-orange-800';
                resultBg = 'bg-orange-100 border border-orange-300';
            } else if (isLTVPossible && !isDSRPossible) {
                // Case 4: DSR ì´ˆê³¼ (ì†Œë“ ë¶€ì¡± ê²½ê³ )
                resultStatus = 'âŒ DSR í•œë„ ì´ˆê³¼ (ëŒ€ì¶œ ìƒí™˜ ë¶ˆê°€)';
                resultColor = 'text-red-800';
                resultBg = 'bg-red-100 border border-red-300';
            } else {
                // Case 5: LTVì™€ DSR ëª¨ë‘ ì´ˆê³¼
                resultStatus = 'ğŸ”¥ LTV ë° DSR í•œë„ ëª¨ë‘ ì´ˆê³¼';
                resultColor = 'text-red-800';
                resultBg = 'bg-red-100 border border-red-300';
            }
        }

        // 5. ê²°ê³¼ í•„ë“œì— ê°’ ì±„ìš°ê¸°
        const formatCurrency = (value) => (value / 100000000).toFixed(2) + 'ì–µ';
        const formatAnnualPayment = (value) => (value / 100000000).toFixed(2) + 'ì–µ/ë…„';

        document.getElementById('ltvMaxLoan').textContent = formatCurrency(ltvMaxLoan);
        document.getElementById('dsrMaxLoan').textContent = formatCurrency(dsrMaxLoan);
        document.getElementById('loanRequired').textContent = formatCurrency(loanRequired);
        document.getElementById('annualPaymentRequired').textContent = formatAnnualPayment(annualPaymentRequired);
        document.getElementById('dsrMaxPayment').textContent = formatAnnualPayment(maxAnnualDSRPayment);

        // ìµœì¢… ê²°ê³¼ UI ì—…ë°ì´íŠ¸
        finalResultCard.className = `p-6 rounded-xl shadow-inner mb-6 transition duration-500 ${resultBg}`;
        mainResultText.className = `text-2xl font-extrabold ${resultColor}`;
        mainResultText.textContent = resultStatus;
        specialMessage.textContent = specialMsg;
        
        resultSection.classList.remove('hidden');
        resultSection.scrollIntoView({ behavior: 'smooth' }); // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
    }

    // ì´ˆê¸° ë¡œë“œ ì‹œ í•œ ë²ˆ ê³„ì‚° ì‹¤í–‰ (ê¸°ë³¸ ê°’ìœ¼ë¡œ)
    window.onload = function() {
        calculateInvestment();
    };

</script>
</body>
</html>
