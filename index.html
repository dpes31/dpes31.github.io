<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 부동산 투자 시뮬레이터</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 16px; background: #f8f9fa; color: #212529; line-height: 1.5; }
        h1 { font-size: 1.5rem; text-align: center; margin: 0 0 24px; }
        .desc { text-align: center; font-size: 0.9rem; color: #6c757d; margin-bottom: 24px; }
        form { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        label { display: block; font-size: 0.95rem; font-weight: 600; margin: 16px 0 6px; }
        input, select { width: 100%; padding: 12px; font-size: 1rem; border: 1.5px solid #ced4da; border-radius: 8px; background: #fff; }
        input:focus, select:focus { border-color: #007bff; outline: none; }
        input::placeholder { color: #adb5bd; }
        .underline { text-decoration: underline; text-decoration-color: #007bff; text-decoration-thickness: 2px; }
        .mid-loan { display: none; }
        button { margin-top: 24px; width: 100%; padding: 14px; background: #007bff; color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600; }
        button:active { background: #0056b3; }
        #result { margin-top: 32px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); display: none; }
        table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }
        th, td { padding: 10px 8px; text-align: left; border-bottom: 1px solid #dee2e6; }
        th { background: #f1f3f5; font-weight: 600; }
        .group { background: #e7f3ff; font-weight: bold; text-align: center; font-size: 0.9rem; }
        .total { font-weight: bold; background: #fff9db; }
        .highlight { font-size: 1.1rem; color: #007bff; }
        .possible { color: #28a745; font-weight: bold; }
        .impossible { color: #dc3545; font-weight: bold; }
        #footer-note { margin-top: 32px; font-size: 0.8rem; color: #6c757d; line-height: 1.5; }
        #alert-popup { display: none; position: fixed; top: 16px; left: 16px; right: 16px; background: #fff3cd; border: 1px solid #ffeaa7; padding: 12px; border-radius: 8px; font-size: 0.9rem; z-index: 1000; }
        .close-btn { float: right; background: none; border: none; font-size: 1.2rem; cursor: pointer; }
    </style>
</head>
<body>
    <h1>2025 부동산 투자 시뮬레이터</h1>
    <p class="desc">일반 매매 · 청약/분양 한눈에 계산 (2025.11.10 기준)</p>

    <form id="simulatorForm">
        <label>주택 유형</label>
        <select id="type" onchange="toggleMidLoan()">
            <option value="buy">일반 매매</option>
            <option value="lottery">청약/분양</option>
        </select>

        <label>주택 가격 (억 원)</label>
        <input type="number" id="price" placeholder="10" step="0.1" oninput="showLotteryLimit()">

        <div id="lottery-limit" style="display:none; background:#e7f3ff; padding:8px; border-radius:6px; font-size:0.9rem; margin:8px 0;"></div>

        <label>보유 자산 (억 원)</label>
        <input type="number" id="assets" placeholder="3" step="0.1">

        <label>투자 지역</label>
        <select id="region">
            <option value="seoul">서울</option>
            <option value="capital">수도권</option>
            <option value="local">지방</option>
        </select>

        <label>연간 소득 (세전, 억 원)</label>
        <input type="number" id="income" placeholder="1" step="0.1">

        <label>보유 주택 수</label>
        <select id="houses">
            <option value="0">무주택</option>
            <option value="1">1주택</option>
            <option value="multi">다주택</option>
        </select>

        <div class="mid-loan">
            <label>건설사 알선 <span class="underline">중도금 대출 비율</span> (%)</label>
            <input type="number" id="midLoanRate" placeholder="40" step="5" min="0" max="60">
            <small style="color:#6c757d;">2025 규제 기본 40% · 회차별 다름</small>
        </div>

        <button type="button" onclick="calculate()">계산하기</button>
    </form>

    <div id="result">
        <h2 style="margin-top:0; font-size:1.3rem;">투자 분석 결과</h2>
        <table>
            <tbody id="receiptTable"></tbody>
        </table>
        <p id="feasibility" style="margin:16px 0 0; font-size:1.1rem;"></p>
    </div>

    <div id="alert-popup">
        ⚠️ 법규 변경 알림 <button class="close-btn" onclick="this.parentElement.style.display='none'">×</button>
    </div>

    <div id="footer-note">
        • 대출 가능액 = LTV·DSR·청약한도 중 가장 낮은 금액<br>
        • 중도금 대출 = 가격 × 비율 (청약 초기 부담 ↓, 잔금 때 은행 대출로 상환)<br>
        • 자기 부담액 = 가격 + 비용 - (잔금대출 + 중도금대출)<br>
        • 잔여 자산 = 보유 자산 - 자기 부담액 → 0 이상이면 투자 가능
    </div>

    <script>
        const reg = {
            lastUpdate: '2025-11-10',
            ltv: { seoul: 0.4, capital: 0.4, local: 0.7 },
            dsrMultiplier: 4.5,
            lotteryLimit: { low: 6, high15: 4, high25: 2 },
            midDefault: 40,
            costs: { bro: 0.005, tax: 0.015, etc: 0.1 }
        };

        function toggleMidLoan() {
            const isLottery = document.getElementById('type').value === 'lottery';
            document.querySelector('.mid-loan').style.display = isLottery ? 'block' : 'none';
            document.getElementById('lottery-limit').style.display = 'none';
            if (isLottery) showLotteryLimit();
        }

        function showLotteryLimit() {
            const price = parseFloat(document.getElementById('price').value) || 0;
            let cap = reg.lotteryLimit.low;
            if (price > 25) cap = reg.lotteryLimit.high25;
            else if (price > 15) cap = reg.lotteryLimit.high15;
            document.getElementById('lottery-limit').innerHTML = `청약 잔금대출 한도: ${cap}억 원 (법정 상한)`;
            document.getElementById('lottery-limit').style.display = 'block';
        }

        // 입력란 클릭 시 placeholder 지우기
        document.querySelectorAll('input[type=number]').forEach(inp => {
            inp.addEventListener('focus', function() { if(this.value === '' || this.value === this.placeholder) this.value = ''; });
            inp.addEventListener('blur', function() { if(this.value === '') this.value = this.placeholder; });
        });

        toggleMidLoan();

        function calculate() {
            const type = document.getElementById('type').value;
            const price = parseFloat(document.getElementById('price').value) || 0;
            const assets = parseFloat(document.getElementById('assets').value) || 0;
            const region = document.getElementById('region').value;
            const income = parseFloat(document.getElementById('income').value) || 0;
            const houses = document.getElementById('houses').value;
            const midRate = type === 'lottery' ? parseFloat(document.getElementById('midLoanRate').value) || 40 : 0;

            // LTV
            let ltv = reg.ltv[region];
            if (houses === 'multi' && (region === 'seoul' || region === 'capital')) ltv = 0;
            if (type === 'lottery' && houses === '0') ltv = 0.7;
            const ltvAmt = price * ltv;

            // DSR
            const dsrAmt = income * reg.dsrMultiplier;

            // 청약 잔금대출 한도
            let finalLoan = Math.min(ltvAmt, dsrAmt);
            if (type === 'lottery') {
                let cap = reg.lotteryLimit.low;
                if (price > 25) cap = reg.lotteryLimit.high25;
                else if (price > 15) cap = reg.lotteryLimit.high15;
                if (region !== 'local') cap = Math.min(cap, 6);
                finalLoan = Math.min(finalLoan, cap);
            }

            // 중도금 대출
            const midLoan = type === 'lottery' ? price * (midRate / 100) : 0;

            // 비용
            const bro = price * reg.costs.bro;
            const tax = price * reg.costs.tax;
            const etc = reg.costs.etc;
            const totalCost = bro + tax + etc;

            // 최종 부담
            const outlay = price + totalCost - finalLoan - midLoan;
            const remain = assets - outlay;

            const ok = remain >= 0;

            // 이유 문자열
            const reason = type === 'lottery' 
                ? `청약한도 ${finalLoan < price * 0.7 ? finalLoan : price * 0.7}억 적용` 
                : `LTV ${ltv*100}%`;

            document.getElementById('receiptTable').innerHTML = `
                <tr class="group"><td colspan="3">주택 가격</td></tr>
                <tr><td>분양/매매가</td><td>${price.toFixed(1)}</td><td></td></tr>

                <tr class="group"><td colspan="3">추가 비용</td></tr>
                <tr><td>중개수수료</td><td>${bro.toFixed(2)}</td><td>0.5%</td></tr>
                <tr><td>취득세</td><td>${tax.toFixed(2)}</td><td>1.5%</td></tr>
                <tr><td>기타</td><td>${etc.toFixed(1)}</td><td>등기 등</td></tr>

                <tr class="group"><td colspan="3">받을 수 있는 대출</td></tr>
                <tr><td>잔금대출 (은행)</td><td>${finalLoan.toFixed(1)}</td><td>${reason}</td></tr>
                ${midLoan > 0 ? `<tr><td>중도금대출 (건설사)</td><td>${midLoan.toFixed(1)}</td><td>${midRate}% 알선 (잔금 상환)</td></tr>` : ''}

                <tr class="group total"><td>실제 내가 내야 할 돈</td><td>${outlay.toFixed(1)}</td><td>가격+비용-대출</td></tr>
                <tr class="total"><td>잔여 자산</td><td class="highlight">${remain.toFixed(1)}</td><td>보유 ${assets.toFixed(1)}억에서 차감</td></tr>
            `;

            document.getElementById('feasibility').innerHTML = `<span class="${ok ? 'possible' : 'impossible'}">
                ${ok ? '투자 가능!' : '아직 무리예요'} (${ok ? '잔여 ' + remain.toFixed(1) + '억' : Math.abs(remain).toFixed(1) + '억 부족'})
            </span>`;

            document.getElementById('result').style.display = 'block';
            window.scrollTo(0, document.getElementById('result').offsetTop - 20);
        }
    </script>
</body>
</html></html>
